'use client';

import { useState, useEffect } from 'react';
import { useRouter } from 'next/navigation';
import Link from 'next/link';

interface Settings {
  general: {
    language: string;
    timezone: string;
    dateFormat: string;
    currency: string;
    darkMode: boolean;
  };
  api: {
    defaultVersion: string;
    responseFormat: string;
    rateLimit: number;
    timeout: number;
    retryAttempts: number;
    webhookUrl: string;
    allowedIPs: string[];
  };
  notifications: {
    email: {
      apiErrors: boolean;
      usageAlerts: boolean;
      weeklyReport: boolean;
      monthlyReport: boolean;
      maintenance: boolean;
    };
    alertThresholds: {
      usage: number;
      errors: number;
      latency: number;
    };
  };
  security: {
    apiKeyExpiry: number;
    ipWhitelist: boolean;
    requireHttps: boolean;
    logRetention: number;
    auditLog: boolean;
  };
  advanced: {
    debugMode: boolean;
    verboseLogging: boolean;
    cacheEnabled: boolean;
    cacheTTL: number;
    compressionEnabled: boolean;
    customHeaders: Record<string, string>;
  };
}

export default function SettingsPage() {
  const router = useRouter();
  const [settings, setSettings] = useState<Settings>({
    general: {
      language: 'ja',
      timezone: 'Asia/Tokyo',
      dateFormat: 'YYYY-MM-DD',
      currency: 'JPY',
      darkMode: false
    },
    api: {
      defaultVersion: 'v1',
      responseFormat: 'json',
      rateLimit: 1000,
      timeout: 30000,
      retryAttempts: 3,
      webhookUrl: '',
      allowedIPs: []
    },
    notifications: {
      email: {
        apiErrors: true,
        usageAlerts: true,
        weeklyReport: false,
        monthlyReport: true,
        maintenance: true
      },
      alertThresholds: {
        usage: 80,
        errors: 10,
        latency: 1000
      }
    },
    security: {
      apiKeyExpiry: 365,
      ipWhitelist: false,
      requireHttps: true,
      logRetention: 30,
      auditLog: true
    },
    advanced: {
      debugMode: false,
      verboseLogging: false,
      cacheEnabled: true,
      cacheTTL: 3600,
      compressionEnabled: true,
      customHeaders: {}
    }
  });

  const [activeSection, setActiveSection] = useState<keyof Settings>('general');
  const [saving, setSaving] = useState(false);
  const [message, setMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);
  const [newIP, setNewIP] = useState('');
  const [newHeaderKey, setNewHeaderKey] = useState('');
  const [newHeaderValue, setNewHeaderValue] = useState('');
  const [showResetModal, setShowResetModal] = useState(false);

  useEffect(() => {
    // LocalStorage„Åã„ÇâË®≠ÂÆö„ÇíË™≠„ÅøËæº„Åø
    const savedSettings = localStorage.getItem('appSettings');
    if (savedSettings) {
      setSettings(JSON.parse(savedSettings));
    }
  }, []);

  const handleSave = async () => {
    setSaving(true);
    setMessage(null);

    try {
      // LocalStorage„Å´‰øùÂ≠òÔºàÂÆüÈöõ„ÅÆÂÆüË£Ö„Åß„ÅØAPI„Çí‰ΩøÁî®Ôºâ
      localStorage.setItem('appSettings', JSON.stringify(settings));
      
      // API„Ç≥„Éº„É´ÔºàÂÆüË£Ö‰æãÔºâ
      const response = await fetch('/api/settings', {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(settings)
      });

      if (response.ok) {
        setMessage({ type: 'success', text: 'Ë®≠ÂÆö„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü' });
      } else {
        throw new Error('Ë®≠ÂÆö„ÅÆ‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
      }
    } catch (error) {
      setMessage({ type: 'error', text: '„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü' });
    } finally {
      setSaving(false);
      setTimeout(() => setMessage(null), 3000);
    }
  };

  const handleReset = () => {
    setSettings({
      general: {
        language: 'ja',
        timezone: 'Asia/Tokyo',
        dateFormat: 'YYYY-MM-DD',
        currency: 'JPY',
        darkMode: false
      },
      api: {
        defaultVersion: 'v1',
        responseFormat: 'json',
        rateLimit: 1000,
        timeout: 30000,
        retryAttempts: 3,
        webhookUrl: '',
        allowedIPs: []
      },
      notifications: {
        email: {
          apiErrors: true,
          usageAlerts: true,
          weeklyReport: false,
          monthlyReport: true,
          maintenance: true
        },
        alertThresholds: {
          usage: 80,
          errors: 10,
          latency: 1000
        }
      },
      security: {
        apiKeyExpiry: 365,
        ipWhitelist: false,
        requireHttps: true,
        logRetention: 30,
        auditLog: true
      },
      advanced: {
        debugMode: false,
        verboseLogging: false,
        cacheEnabled: true,
        cacheTTL: 3600,
        compressionEnabled: true,
        customHeaders: {}
      }
    });
    setShowResetModal(false);
    setMessage({ type: 'success', text: 'Ë®≠ÂÆö„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åó„Åü' });
  };

  const addIP = () => {
    if (newIP && /^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/.test(newIP)) {
      setSettings({
        ...settings,
        api: {
          ...settings.api,
          allowedIPs: [...settings.api.allowedIPs, newIP]
        }
      });
      setNewIP('');
    }
  };

  const removeIP = (ip: string) => {
    setSettings({
      ...settings,
      api: {
        ...settings.api,
        allowedIPs: settings.api.allowedIPs.filter(i => i !== ip)
      }
    });
  };

  const addHeader = () => {
    if (newHeaderKey && newHeaderValue) {
      setSettings({
        ...settings,
        advanced: {
          ...settings.advanced,
          customHeaders: {
            ...settings.advanced.customHeaders,
            [newHeaderKey]: newHeaderValue
          }
        }
      });
      setNewHeaderKey('');
      setNewHeaderValue('');
    }
  };

  const removeHeader = (key: string) => {
    const { [key]: _, ...rest } = settings.advanced.customHeaders;
    setSettings({
      ...settings,
      advanced: {
        ...settings.advanced,
        customHeaders: rest
      }
    });
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50">
      {/* „Éò„ÉÉ„ÉÄ„Éº */}
      <header className="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex justify-between items-center h-16">
            <div className="flex items-center gap-4">
              <button onClick={() => router.push('/dashboard')} className="text-gray-600 hover:text-gray-900">
                ‚Üê „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„Å´Êàª„Çã
              </button>
              <span className="text-gray-400">|</span>
              <h1 className="text-xl font-bold">Ë®≠ÂÆö</h1>
            </div>
            <div className="flex gap-3">
              <button
                onClick={() => setShowResetModal(true)}
                className="px-4 py-2 text-gray-600 hover:text-gray-900"
              >
                „É™„Çª„ÉÉ„Éà
              </button>
              <button
                onClick={handleSave}
                disabled={saving}
                className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"
              >
                {saving ? '‰øùÂ≠ò‰∏≠...' : 'Ë®≠ÂÆö„Çí‰øùÂ≠ò'}
              </button>
            </div>
          </div>
        </div>
      </header>

      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        {/* „É°„ÉÉ„Çª„Éº„Ç∏Ë°®Á§∫ */}
        {message && (
          <div className={`mb-4 p-4 rounded-lg transition-all ${
            message.type === 'success' 
              ? 'bg-green-50 text-green-800 border border-green-200' 
              : 'bg-red-50 text-red-800 border border-red-200'
          }`}>
            <div className="flex items-center gap-2">
              {message.type === 'success' ? (
                <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                  <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                </svg>
              ) : (
                <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                  <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clipRule="evenodd" />
                </svg>
              )}
              {message.text}
            </div>
          </div>
        )}

        <div className="flex gap-6">
          {/* „Çµ„Ç§„Éâ„Éê„Éº */}
          <div className="w-64 flex-shrink-0">
            <nav className="bg-white rounded-xl shadow-sm p-2">
              {[
                { id: 'general', label: '‰∏ÄËà¨Ë®≠ÂÆö', icon: '‚öôÔ∏è' },
                { id: 'api', label: 'APIË®≠ÂÆö', icon: 'üîå' },
                { id: 'notifications', label: 'ÈÄöÁü•', icon: 'üîî' },
                { id: 'security', label: '„Çª„Ç≠„É•„É™„ÉÜ„Ç£', icon: 'üîí' },
                { id: 'advanced', label: 'Ë©≥Á¥∞Ë®≠ÂÆö', icon: 'üõ†Ô∏è' }
              ].map(section => (
                <button
                  key={section.id}
                  onClick={() => setActiveSection(section.id as keyof Settings)}
                  className={`w-full text-left px-4 py-3 rounded-lg mb-1 transition-colors flex items-center gap-3 ${
                    activeSection === section.id
                      ? 'bg-blue-50 text-blue-600 font-medium'
                      : 'hover:bg-gray-50 text-gray-700'
                  }`}
                >
                  <span>{section.icon}</span>
                  {section.label}
                </button>
              ))}
            </nav>

            {/* „ÇØ„Ç§„ÉÉ„ÇØ„É™„É≥„ÇØ */}
            <div className="mt-6 bg-white rounded-xl shadow-sm p-4">
              <h3 className="font-medium text-gray-900 mb-3">„ÇØ„Ç§„ÉÉ„ÇØ„É™„É≥„ÇØ</h3>
              <div className="space-y-2">
                <Link href="/dashboard/apikeys" className="block text-sm text-blue-600 hover:underline">
                  ‚Üí API„Ç≠„ÉºÁÆ°ÁêÜ
                </Link>
                <Link href="/docs" className="block text-sm text-blue-600 hover:underline">
                  ‚Üí API„Éâ„Ç≠„É•„É°„É≥„Éà
                </Link>
                <Link href="/profile" className="block text-sm text-blue-600 hover:underline">
                  ‚Üí „Éó„É≠„Éï„Ç£„Éº„É´
                </Link>
                <Link href="/support" className="block text-sm text-blue-600 hover:underline">
                  ‚Üí „Çµ„Éù„Éº„Éà
                </Link>
              </div>
            </div>
          </div>

          {/* „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ */}
          <div className="flex-1 bg-white rounded-xl shadow-sm p-6">
            {/* ‰∏ÄËà¨Ë®≠ÂÆö */}
            {activeSection === 'general' && (
              <div>
                <h2 className="text-xl font-bold mb-6">‰∏ÄËà¨Ë®≠ÂÆö</h2>
                <div className="space-y-6">
                  <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">Ë®ÄË™û</label>
                      <select
                        value={settings.general.language}
                        onChange={(e) => setSettings({
                          ...settings,
                          general: { ...settings.general, language: e.target.value }
                        })}
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      >
                        <option value="ja">Êó•Êú¨Ë™û</option>
                        <option value="en">English</option>
                        <option value="zh">‰∏≠Êñá</option>
                        <option value="ko">ÌïúÍµ≠Ïñ¥</option>
                      </select>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">„Çø„Ç§„É†„Çæ„Éº„É≥</label>
                      <select
                        value={settings.general.timezone}
                        onChange={(e) => setSettings({
                          ...settings,
                          general: { ...settings.general, timezone: e.target.value }
                        })}
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      >
                        <option value="Asia/Tokyo">Êù±‰∫¨ (GMT+9)</option>
                        <option value="America/New_York">„Éã„É•„Éº„É®„Éº„ÇØ (GMT-5)</option>
                        <option value="Europe/London">„É≠„É≥„Éâ„É≥ (GMT+0)</option>
                        <option value="Asia/Singapore">„Ç∑„É≥„Ç¨„Éù„Éº„É´ (GMT+8)</option>
                      </select>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">Êó•‰ªòÂΩ¢Âºè</label>
                      <select
                        value={settings.general.dateFormat}
                        onChange={(e) => setSettings({
                          ...settings,
                          general: { ...settings.general, dateFormat: e.target.value }
                        })}
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      >
                        <option value="YYYY-MM-DD">2024-01-15</option>
                        <option value="DD/MM/YYYY">15/01/2024</option>
                        <option value="MM/DD/YYYY">01/15/2024</option>
                        <option value="YYYYÂπ¥MMÊúàDDÊó•">2024Âπ¥01Êúà15Êó•</option>
                      </select>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">ÈÄöË≤®</label>
                      <select
                        value={settings.general.currency}
                        onChange={(e) => setSettings({
                          ...settings,
                          general: { ...settings.general, currency: e.target.value }
                        })}
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      >
                        <option value="JPY">Êó•Êú¨ÂÜÜ (¬•)</option>
                        <option value="USD">Á±≥„Éâ„É´ ($)</option>
                        <option value="EUR">„É¶„Éº„É≠ (‚Ç¨)</option>
                        <option value="GBP">Ëã±„Éù„É≥„Éâ (¬£)</option>
                      </select>
                    </div>
                  </div>

                  <div className="border-t pt-6">
                    <div className="flex items-center justify-between">
                      <div>
                        <h3 className="font-medium text-gray-900">„ÉÄ„Éº„ÇØ„É¢„Éº„Éâ</h3>
                        <p className="text-sm text-gray-600 mt-1">„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ„ÇíÊöó„ÅÑ„ÉÜ„Éº„Éû„Å´Âàá„ÇäÊõø„Åà„Åæ„Åô</p>
                      </div>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input
                          type="checkbox"
                          checked={settings.general.darkMode}
                          onChange={(e) => setSettings({
                            ...settings,
                            general: { ...settings.general, darkMode: e.target.checked }
                          })}
                          className="sr-only peer"
                        />
                        <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            )}

            {/* APIË®≠ÂÆö */}
            {activeSection === 'api' && (
              <div>
                <h2 className="text-xl font-bold mb-6">APIË®≠ÂÆö</h2>
                <div className="space-y-6">
                  <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">„Éá„Éï„Ç©„É´„ÉàAPI„Éê„Éº„Ç∏„Éß„É≥</label>
                      <select
                        value={settings.api.defaultVersion}
                        onChange={(e) => setSettings({
                          ...settings,
                          api: { ...settings.api, defaultVersion: e.target.value }
                        })}
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      >
                        <option value="v1">v1 (ÂÆâÂÆöÁâà)</option>
                        <option value="v2-beta">v2-beta („Éô„Éº„ÇøÁâà)</option>
                      </select>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">„É¨„Çπ„Éù„É≥„ÇπÂΩ¢Âºè</label>
                      <select
                        value={settings.api.responseFormat}
                        onChange={(e) => setSettings({
                          ...settings,
                          api: { ...settings.api, responseFormat: e.target.value }
                        })}
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      >
                        <option value="json">JSON</option>
                        <option value="xml">XML</option>
                        <option value="csv">CSV</option>
                      </select>
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        „É¨„Éº„ÉàÂà∂Èôê („É™„ÇØ„Ç®„Çπ„Éà/Êúà)
                      </label>
                      <input
                        type="number"
                        value={settings.api.rateLimit}
                        onChange={(e) => setSettings({
                          ...settings,
                          api: { ...settings.api, rateLimit: parseInt(e.target.value) }
                        })}
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      />
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        „Çø„Ç§„É†„Ç¢„Ç¶„Éà („Éü„É™Áßí)
                      </label>
                      <input
                        type="number"
                        value={settings.api.timeout}
                        onChange={(e) => setSettings({
                          ...settings,
                          api: { ...settings.api, timeout: parseInt(e.target.value) }
                        })}
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      />
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">„É™„Éà„É©„Ç§ÂõûÊï∞</label>
                      <input
                        type="number"
                        value={settings.api.retryAttempts}
                        onChange={(e) => setSettings({
                          ...settings,
                          api: { ...settings.api, retryAttempts: parseInt(e.target.value) }
                        })}
                        min="0"
                        max="5"
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      />
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">Webhook URL</label>
                      <input
                        type="url"
                        value={settings.api.webhookUrl}
                        onChange={(e) => setSettings({
                          ...settings,
                          api: { ...settings.api, webhookUrl: e.target.value }
                        })}
                        placeholder="https://example.com/webhook"
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      />
                    </div>
                  </div>

                  <div className="border-t pt-6">
                    <h3 className="font-medium text-gray-900 mb-4">Ë®±ÂèØIP„Ç¢„Éâ„É¨„Çπ</h3>
                    <div className="flex gap-2 mb-4">
                      <input
                        type="text"
                        value={newIP}
                        onChange={(e) => setNewIP(e.target.value)}
                        placeholder="192.168.1.1"
                        className="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      />
                      <button
                        onClick={addIP}
                        className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                      >
                        ËøΩÂä†
                      </button>
                    </div>
                    <div className="space-y-2">
                      {settings.api.allowedIPs.map(ip => (
                        <div key={ip} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                          <span className="font-mono">{ip}</span>
                          <button
                            onClick={() => removeIP(ip)}
                            className="text-red-600 hover:text-red-700"
                          >
                            ÂâäÈô§
                          </button>
                        </div>
                      ))}
                      {settings.api.allowedIPs.length === 0 && (
                        <p className="text-sm text-gray-500">IP„Ç¢„Éâ„É¨„ÇπÂà∂Èôê„Å™„ÅóÔºà„Åô„Åπ„Å¶Ë®±ÂèØÔºâ</p>
                      )}
                    </div>
                  </div>
                </div>
              </div>
            )}

            {/* ÈÄöÁü•Ë®≠ÂÆö */}
            {activeSection === 'notifications' && (
              <div>
                <h2 className="text-xl font-bold mb-6">ÈÄöÁü•Ë®≠ÂÆö</h2>
                <div className="space-y-6">
                  <div>
                    <h3 className="font-medium text-gray-900 mb-4">„É°„Éº„É´ÈÄöÁü•</h3>
                    <div className="space-y-4">
                      {[
                        { key: 'apiErrors', label: 'API„Ç®„É©„Éº', description: 'APIÂëº„Å≥Âá∫„Åó„Åß„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„ÅüÂ†¥Âêà„Å´ÈÄöÁü•' },
                        { key: 'usageAlerts', label: '‰ΩøÁî®Èáè„Ç¢„É©„Éº„Éà', description: '‰ΩøÁî®Èáè„ÅåÈñæÂÄ§„ÇíË∂Ö„Åà„ÅüÂ†¥Âêà„Å´ÈÄöÁü•' },
                        { key: 'weeklyReport', label: 'ÈÄ±Ê¨°„É¨„Éù„Éº„Éà', description: 'ÊØéÈÄ±ÊúàÊõúÊó•„Å´‰ΩøÁî®Áä∂Ê≥Å„Çí„É¨„Éù„Éº„Éà' },
                        { key: 'monthlyReport', label: 'ÊúàÊ¨°„É¨„Éù„Éº„Éà', description: 'ÊØéÊúà1Êó•„Å´Ë©≥Á¥∞„Å™ÂàÜÊûê„É¨„Éù„Éº„Éà' },
                        { key: 'maintenance', label: '„É°„É≥„ÉÜ„Éä„É≥„ÇπÈÄöÁü•', description: '„Ç∑„Çπ„ÉÜ„É†„É°„É≥„ÉÜ„Éä„É≥„ÇπÊÉÖÂ†±' }
                      ].map(item => (
                        <div key={item.key} className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                          <div>
                            <p className="font-medium">{item.label}</p>
                            <p className="text-sm text-gray-600">{item.description}</p>
                          </div>
                          <label className="relative inline-flex items-center cursor-pointer">
                            <input
                              type="checkbox"
                              checked={settings.notifications.email[item.key as keyof typeof settings.notifications.email]}
                              onChange={(e) => setSettings({
                                ...settings,
                                notifications: {
                                  ...settings.notifications,
                                  email: {
                                    ...settings.notifications.email,
                                    [item.key]: e.target.checked
                                  }
                                }
                              })}
                              className="sr-only peer"
                            />
                            <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                          </label>
                        </div>
                      ))}
                    </div>
                  </div>

                  <div className="border-t pt-6">
                    <h3 className="font-medium text-gray-900 mb-4">„Ç¢„É©„Éº„ÉàÈñæÂÄ§</h3>
                    <div className="grid grid-cols-3 gap-4">
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          ‰ΩøÁî®Èáè (%)
                        </label>
                        <input
                          type="number"
                          value={settings.notifications.alertThresholds.usage}
                          onChange={(e) => setSettings({
                            ...settings,
                            notifications: {
                              ...settings.notifications,
                              alertThresholds: {
                                ...settings.notifications.alertThresholds,
                                usage: parseInt(e.target.value)
                              }
                            }
                          })}
                          min="0"
                          max="100"
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          „Ç®„É©„ÉºÊï∞
                        </label>
                        <input
                          type="number"
                          value={settings.notifications.alertThresholds.errors}
                          onChange={(e) => setSettings({
                            ...settings,
                            notifications: {
                              ...settings.notifications,
                              alertThresholds: {
                                ...settings.notifications.alertThresholds,
                                errors: parseInt(e.target.value)
                              }
                            }
                          })}
                          min="0"
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          „É¨„Ç§„ÉÜ„É≥„Ç∑ (ms)
                        </label>
                        <input
                          type="number"
                          value={settings.notifications.alertThresholds.latency}
                          onChange={(e) => setSettings({
                            ...settings,
                            notifications: {
                              ...settings.notifications,
                              alertThresholds: {
                                ...settings.notifications.alertThresholds,
                                latency: parseInt(e.target.value)
                              }
                            }
                          })}
                          min="0"
                          className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            )}

            {/* „Çª„Ç≠„É•„É™„ÉÜ„Ç£Ë®≠ÂÆö */}
            {activeSection === 'security' && (
              <div>
                <h2 className="text-xl font-bold mb-6">„Çª„Ç≠„É•„É™„ÉÜ„Ç£Ë®≠ÂÆö</h2>
                <div className="space-y-6">
                  <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        API„Ç≠„ÉºÊúâÂäπÊúüÈôê (Êó•)
                      </label>
                      <input
                        type="number"
                        value={settings.security.apiKeyExpiry}
                        onChange={(e) => setSettings({
                          ...settings,
                          security: { ...settings.security, apiKeyExpiry: parseInt(e.target.value) }
                        })}
                        min="1"
                        max="365"
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      />
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        „É≠„Ç∞‰øùÊåÅÊúüÈñì (Êó•)
                      </label>
                      <input
                        type="number"
                        value={settings.security.logRetention}
                        onChange={(e) => setSettings({
                          ...settings,
                          security: { ...settings.security, logRetention: parseInt(e.target.value) }
                        })}
                        min="1"
                        max="365"
                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      />
                    </div>
                  </div>

                  <div className="space-y-4">
                    <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                      <div>
                        <p className="font-medium">IP„Éõ„ÉØ„Ç§„Éà„É™„Çπ„Éà</p>
                        <p className="text-sm text-gray-600">ÊåáÂÆö„Åó„ÅüIP„Ç¢„Éâ„É¨„Çπ„Åã„Çâ„ÅÆ„Åø„Ç¢„ÇØ„Çª„ÇπË®±ÂèØ</p>
                      </div>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input
                          type="checkbox"
                          checked={settings.security.ipWhitelist}
                          onChange={(e) => setSettings({
                            ...settings,
                            security: { ...settings.security, ipWhitelist: e.target.checked }
                          })}
                          className="sr-only peer"
                        />
                        <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                      </label>
                    </div>

                    <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                      <div>
                        <p className="font-medium">HTTPSÂøÖÈ†à</p>
                        <p className="text-sm text-gray-600">„Åô„Åπ„Å¶„ÅÆAPIÈÄö‰ø°„ÅßHTTPS„ÇíÂº∑Âà∂</p>
                      </div>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input
                          type="checkbox"
                          checked={settings.security.requireHttps}
                          onChange={(e) => setSettings({
                            ...settings,
                            security: { ...settings.security, requireHttps: e.target.checked }
                          })}
                          className="sr-only peer"
                        />
                        <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                      </label>
                    </div>

                    <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                      <div>
                        <p className="font-medium">Áõ£Êüª„É≠„Ç∞</p>
                        <p className="text-sm text-gray-600">„Åô„Åπ„Å¶„ÅÆAPIÂëº„Å≥Âá∫„Åó„ÇíË®òÈå≤</p>
                      </div>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input
                          type="checkbox"
                          checked={settings.security.auditLog}
                          onChange={(e) => setSettings({
                            ...settings,
                            security: { ...settings.security, auditLog: e.target.checked }
                          })}
                          className="sr-only peer"
                        />
                        <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                      </label>
                    </div>
                  </div>

                  <div className="border-t pt-6">
                    <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                      <div className="flex items-start gap-3">
                        <svg className="w-6 h-6 text-yellow-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                        </svg>
                        <div>
                          <p className="font-medium text-yellow-800">„Çª„Ç≠„É•„É™„ÉÜ„Ç£Êé®Â•®‰∫ãÈ†Ö</p>
                          <ul className="mt-2 text-sm text-yellow-700 space-y-1">
                            <li>‚Ä¢ ÂÆöÊúüÁöÑ„Å´API„Ç≠„Éº„ÇíÊõ¥Êñ∞„Åó„Å¶„Åè„Å†„Åï„ÅÑ</li>
                            <li>‚Ä¢ ‰∏çË¶Å„Å™IP„Ç¢„Éâ„É¨„Çπ„ÅØË®±ÂèØ„É™„Çπ„Éà„Åã„ÇâÂâäÈô§„Åó„Å¶„Åè„Å†„Åï„ÅÑ</li>
                            <li>‚Ä¢ Áõ£Êüª„É≠„Ç∞„ÇíÂÆöÊúüÁöÑ„Å´Á¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ</li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            )}

            {/* Ë©≥Á¥∞Ë®≠ÂÆö */}
            {activeSection === 'advanced' && (
              <div>
                <h2 className="text-xl font-bold mb-6">Ë©≥Á¥∞Ë®≠ÂÆö</h2>
                <div className="space-y-6">
                  <div className="space-y-4">
                    <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                      <div>
                        <p className="font-medium">„Éá„Éê„ÉÉ„Ç∞„É¢„Éº„Éâ</p>
                        <p className="text-sm text-gray-600">Ë©≥Á¥∞„Å™„Ç®„É©„ÉºÊÉÖÂ†±„ÇíË°®Á§∫</p>
                      </div>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input
                          type="checkbox"
                          checked={settings.advanced.debugMode}
                          onChange={(e) => setSettings({
                            ...settings,
                            advanced: { ...settings.advanced, debugMode: e.target.checked }
                          })}
                          className="sr-only peer"
                        />
                        <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                      </label>
                    </div>

                    <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                      <div>
                        <p className="font-medium">Ë©≥Á¥∞„É≠„Ç∞</p>
                        <p className="text-sm text-gray-600">„Åô„Åπ„Å¶„ÅÆAPIÊìç‰Ωú„ÇíË©≥Á¥∞„Å´Ë®òÈå≤</p>
                      </div>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input
                          type="checkbox"
                          checked={settings.advanced.verboseLogging}
                          onChange={(e) => setSettings({
                            ...settings,
                            advanced: { ...settings.advanced, verboseLogging: e.target.checked }
                          })}
                          className="sr-only peer"
                        />
                        <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                      </label>
                    </div>

                    <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                      <div>
                        <p className="font-medium">„Ç≠„É£„ÉÉ„Ç∑„É•</p>
                        <p className="text-sm text-gray-600">API„É¨„Çπ„Éù„É≥„Çπ„Çí„Ç≠„É£„ÉÉ„Ç∑„É•„Åó„Å¶È´òÈÄüÂåñ</p>
                      </div>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input
                          type="checkbox"
                          checked={settings.advanced.cacheEnabled}
                          onChange={(e) => setSettings({
                            ...settings,
                            advanced: { ...settings.advanced, cacheEnabled: e.target.checked }
                          })}
                          className="sr-only peer"
                        />
                        <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                      </label>
                    </div>

                    <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                      <div>
                        <p className="font-medium">ÂúßÁ∏Æ</p>
                        <p className="text-sm text-gray-600">„É¨„Çπ„Éù„É≥„Çπ„ÇígzipÂúßÁ∏Æ„Åó„Å¶Ëª¢ÈÄÅÈáè„ÇíÂâäÊ∏õ</p>
                      </div>
                      <label className="relative inline-flex items-center cursor-pointer">
                        <input
                          type="checkbox"
                          checked={settings.advanced.compressionEnabled}
                          onChange={(e) => setSettings({
                            ...settings,
                            advanced: { ...settings.advanced, compressionEnabled: e.target.checked }
                          })}
                          className="sr-only peer"
                        />
                        <div className="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                      </label>
                    </div>
                  </div>

                  {settings.advanced.cacheEnabled && (
                    <div className="border-t pt-6">
                      <label className="block text-sm font-medium text-gray-700 mb-2">
                        „Ç≠„É£„ÉÉ„Ç∑„É•ÊúâÂäπÊúüÈôê (Áßí)
                      </label>
                      <input
                        type="number"
                        value={settings.advanced.cacheTTL}
                        onChange={(e) => setSettings({
                          ...settings,
                          advanced: { ...settings.advanced, cacheTTL: parseInt(e.target.value) }
                        })}
                        min="0"
                        className="w-full max-w-xs px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      />
                    </div>
                  )}

                  <div className="border-t pt-6">
                    <h3 className="font-medium text-gray-900 mb-4">„Ç´„Çπ„Çø„É†„Éò„ÉÉ„ÉÄ„Éº</h3>
                    <div className="flex gap-2 mb-4">
                      <input
                        type="text"
                        value={newHeaderKey}
                        onChange={(e) => setNewHeaderKey(e.target.value)}
                        placeholder="Header-Name"
                        className="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      />
                      <input
                        type="text"
                        value={newHeaderValue}
                        onChange={(e) => setNewHeaderValue(e.target.value)}
                        placeholder="Header-Value"
                        className="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                      />
                      <button
                        onClick={addHeader}
                        className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                      >
                        ËøΩÂä†
                      </button>
                    </div>
                    <div className="space-y-2">
                      {Object.entries(settings.advanced.customHeaders).map(([key, value]) => (
                        <div key={key} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                          <span className="font-mono text-sm">{key}: {value}</span>
                          <button
                            onClick={() => removeHeader(key)}
                            className="text-red-600 hover:text-red-700"
                          >
                            ÂâäÈô§
                          </button>
                        </div>
                      ))}
                      {Object.keys(settings.advanced.customHeaders).length === 0 && (
                        <p className="text-sm text-gray-500">„Ç´„Çπ„Çø„É†„Éò„ÉÉ„ÉÄ„Éº„Å™„Åó</p>
                      )}
                    </div>
                  </div>
                </div>
              </div>
            )}
          </div>
        </div>
      </div>

      {/* „É™„Çª„ÉÉ„ÉàÁ¢∫Ë™ç„É¢„Éº„ÉÄ„É´ */}
      {showResetModal && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-white rounded-xl p-6 max-w-md w-full mx-4">
            <h3 className="text-xl font-bold mb-4">Ë®≠ÂÆö„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åô„ÅãÔºü</h3>
            <p className="text-gray-600 mb-6">
              „Åô„Åπ„Å¶„ÅÆË®≠ÂÆö„Åå„Éá„Éï„Ç©„É´„ÉàÂÄ§„Å´Êàª„Çä„Åæ„Åô„ÄÇ„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ
            </p>
            <div className="flex gap-3">
              <button
                onClick={() => setShowResetModal(false)}
                className="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"
              >
                „Ç≠„É£„É≥„Çª„É´
              </button>
              <button
                onClick={handleReset}
                className="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"
              >
                „É™„Çª„ÉÉ„Éà
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}