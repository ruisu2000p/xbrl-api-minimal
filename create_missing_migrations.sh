#!/bin/bash

# Create all missing migration files
migrations=(
"20250913030322_create_profile_on_signup_trigger.sql"
"20250913042237_create_auth_trigger_for_profiles.sql"
"20250913044240_create_profile_trigger.sql"
"20250913044254_setup_profiles_rls.sql"
"20250913045626_fix_profiles_email_constraint.sql"
"20250913074627_create_api_key_rate_limits_table.sql"
"20250913074649_add_missing_api_keys_columns.sql"
"20250913082121_create_subscription_plans_and_user_subscriptions.sql"
"20250914030739_security_improvements_fixed.sql"
"20250914030820_fix_security_definer_view_corrected.sql"
"20250915044115_optimize_indexes_phase1.sql"
"20250915044748_remove_sector_index.sql"
"20250916061023_add_missing_api_keys_columns.sql"
"20250916061625_add_masked_key_and_rate_limit_columns.sql"
"20250918031701_add_verify_api_key_with_hash_function.sql"
"20250918031753_update_test_api_key_hash.sql"
"20250918031948_fix_verify_api_key_function.sql"
"20250918032107_fix_random_function.sql"
"20250918032125_create_bcrypt_verify_function.sql"
"20250918052459_add_verify_api_key_bcrypt_function.sql"
"20250918053108_implement_bcrypt_complete_system.sql"
"20250918054935_add_public_id_for_o1_optimization.sql"
"20250918054955_create_optimized_api_key_functions.sql"
"20250918055024_create_rate_limit_system.sql"
"20250918055108_create_audit_log_system.sql"
"20250918055154_create_pagination_functions.sql"
"20250919061447_add_salt_column_to_api_keys.sql"
"20250919082029_enable_rls_on_owned_tables.sql"
"20250919082106_add_rls_policies_corrected.sql"
"20250919082135_fix_security_definer_views.sql"
"20250919082334_set_function_search_paths_correctly.sql"
"20250919082400_remove_remaining_security_definer_views.sql"
"20250919082515_recreate_views_without_security_definer.sql"
"20250919083134_set_search_path_for_remaining_functions.sql"
"20250919083759_revoke_wrappers_fdw_stats_api_access.sql"
"20250919083815_revoke_all_wrappers_fdw_stats_permissions.sql"
"20250919090625_create_private_schema_and_lockdown.sql"
"20250919093745_fix_verify_api_key_hash_uuid_parsing.sql"
"20250919093835_fix_api_key_hash_verification_with_hmac.sql"
"20250919094006_fix_api_key_hash_verification_final.sql"
"20250919094226_create_api_key_config_table.sql"
"20250919094557_fix_markdown_metadata_public_access.sql"
)

for migration in "${migrations[@]}"; do
  echo "-- Migration already applied on remote database" > "supabase/migrations/$migration"
  echo "Created: $migration"
done
